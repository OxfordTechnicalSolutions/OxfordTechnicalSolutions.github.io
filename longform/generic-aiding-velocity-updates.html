<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Velocity &mdash; OxTS C++ Generic Aiding SDK  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Attitude" href="generic-aiding-attitude-updates.html" />
    <link rel="prev" title="Position" href="generic-aiding-position-updates.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            OxTS C++ Generic Aiding SDK
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction to Generic Aiding</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="generic-aiding-requirements.html">Generic Aiding Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="timestamps.html">Timestamping Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="sensorcharacterisation.html">Sensor characterisation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Aiding types</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="generic-aiding-position-updates.html">Position</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Velocity</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#aiding-frames">Aiding frames</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#north-east-up-frame">North, East, Up frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="#user-defined-local-frame">User-defined local frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="#odometry-frame-beta">Odometry frame (beta)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#covariance-matrix">Covariance matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lever-arm">Lever Arm</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="generic-aiding-attitude-updates.html">Attitude</a></li>
<li class="toctree-l1"><a class="reference internal" href="generic-aiding-heading-updates.html">Heading</a></li>
<li class="toctree-l1"><a class="reference internal" href="generic-aiding-speed-updates.html">Speed</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="example-my-first-gad.html">My First GAD</a></li>
<li class="toctree-l1"><a class="reference internal" href="example-static-aiding.html">Static Aiding</a></li>
<li class="toctree-l1"><a class="reference internal" href="example-static-aiding-no-boost.html">Static Aiding (No Boost)</a></li>
<li class="toctree-l1"><a class="reference internal" href="example-zv-wheelspeed.html">Zero Velocity Wheelspeed</a></li>
<li class="toctree-l1"><a class="reference internal" href="example-heading.html">Heading Update Example</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional Material</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="defining-a-local-reference-frame.html">User-defined Local Frame</a></li>
<li class="toctree-l1"><a class="reference internal" href="gad-files.html">.gad files (Advanced)</a></li>
<li class="toctree-l1"><a class="reference internal" href="reassigning-traditional-sources.html">Reassigning traditional data sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="stream-priority.html">Stream priority</a></li>
<li class="toctree-l1"><a class="reference internal" href="position-only-initialisation.html">Initialisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="position-only-initialisation.html#position-only-initialisation">Position-only initialisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="is-my-data-being-received.html">Is my data being received?</a></li>
<li class="toctree-l1"><a class="reference internal" href="ncom-updates.html">NCOM Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced-commands.html">Advanced commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced-commands.html#all-configuration-options">All configuration options</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../gal-cpp/index.html">C++</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OxTS C++ Generic Aiding SDK</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Velocity</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/longform/generic-aiding-velocity-updates.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="velocity">
<span id="gadvelocitypage"></span><h1>Velocity<a class="headerlink" href="#velocity" title="Link to this heading"></a></h1>
<p>The GA interface allows users to send a number of measurement updates to an
OxTS INS from external devices/ sensors, including velocity estimates. Each of
the fields for this data type can be set using functions from the
<a class="reference internal" href="../gal-cpp/gal-cpp_gad.html#gadvelocityclass"><span class="std std-ref">GadVelocity</span></a> class.</p>
<section id="aiding-frames">
<span id="velocityaidingframes"></span><h2>Aiding frames<a class="headerlink" href="#aiding-frames" title="Link to this heading"></a></h2>
<p>Velocity aiding can be provided to the INS in more than one coordinate frame, based on the needs of the user.</p>
<section id="north-east-up-frame">
<span id="velocityaidingframesneu"></span><h3>North, East, Up frame<a class="headerlink" href="#north-east-up-frame" title="Link to this heading"></a></h3>
<p>The NEU frame is the simplest way to provide velocity aiding to the INS, since it requires no other configuration. Note that this is a left-handed coordinate system.</p>
<p>Velocity measurements in this frame are expected in <span class="math notranslate nohighlight">\(m/s\)</span>.</p>
</section>
<section id="user-defined-local-frame">
<span id="velocityaidingframeslocal"></span><h3>User-defined local frame<a class="headerlink" href="#user-defined-local-frame" title="Link to this heading"></a></h3>
<p>Velocity aiding supports a user-defined local frame. More information on how to define the frame itself can be found on the relevant page.</p>
<p>Velocity measurements in this frame are expected in <span class="math notranslate nohighlight">\(m/s\)</span> .</p>
</section>
<section id="odometry-frame-beta">
<span id="velocityaidingframesodometry"></span><h3>Odometry frame (beta)<a class="headerlink" href="#odometry-frame-beta" title="Link to this heading"></a></h3>
<p>For this aiding frame, data is expected in the frame of an odometry sensor fixed to the vehicle. In order to use this frame, the transformation between the sensor and the INS must be specified in the INS configuration. This can be done with advanced commands in NAVconfig or in the mobile.cfg file directly on the unit.</p>
<p>The odometry frame requires a rotational transformation as well as the standard lever arm, which is specified in much the same way in the following commands:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">attitude</span><span class="p">[</span><span class="n">att_id</span><span class="p">]</span><span class="n">_</span><span class="p">[</span><span class="n">heading</span><span class="p">]</span><span class="n">_</span><span class="p">[</span><span class="n">pitch</span><span class="p">]</span><span class="n">_</span><span class="p">[</span><span class="n">roll</span><span class="p">]</span><span class="n">_</span><span class="p">[</span><span class="n">var_hea</span><span class="p">]</span><span class="n">_</span><span class="p">[</span><span class="o">*</span><span class="n">var_pit</span><span class="p">]</span><span class="n">_</span><span class="p">[</span><span class="o">*</span><span class="n">var_roll</span><span class="p">]</span>
<span class="o">-</span><span class="n">gad_on</span><span class="p">[</span><span class="n">stream_id</span><span class="p">]</span>
<span class="o">-</span><span class="n">gad_att_id</span><span class="p">[</span><span class="n">stream_id</span><span class="p">]</span><span class="n">_</span><span class="p">[</span><span class="n">att_id</span><span class="p">]</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="advanced-commands.html#advancedcommands"><span class="std std-ref">Advanced commands</span></a> for more information.</p>
<p>The <cite>-attitude</cite> option sets the orientation of the sensor frame with respect to the IMU frame.  The angles are defined intrinsically, following the <span class="math notranslate nohighlight">\(Z_1 Y_2 X_3\)</span> convention in degrees.
The <cite>var_pit</cite> and <cite>var_roll</cite> inputs are optional, with the <cite>var_hea</cite> option being used for all three variances if the others are not specified. Note you must specify either one or three variances.</p>
<p>The <cite>-location</cite> option specifies the lever arm <span class="math notranslate nohighlight">\((x,y,z)\)</span>. This defines the translation from the IMU to the aiding sensor, in the IMU frame. See the lever arm documentation for further information.</p>
<p>A stream Id is a unique identifier for each GAD input.  One device can output any number of streams, these streams would each have different Ids.  When sending your data to the INS you should ensure each data source has a unique Id.</p>
<section id="example">
<span id="velocityodomexample"></span><h4>Example<a class="headerlink" href="#example" title="Link to this heading"></a></h4>
<p>Defining the lever arm in the IMU frame is relatively intuitive, but finding
the angles of rotation can be less so for those who have not done it before.
Hence, we provide an example.</p>
<p>Say we are using a LiDAR as our odometry source, and we want to define the
YPR angles.</p>
<img alt="../_images/velocity-odom-frame-rotation-georef.gif" src="../_images/velocity-odom-frame-rotation-georef.gif" />
<p>We can do this by most intuitively by starting with the LiDAR frame and
rotating it until it aligns with the IMU frame. This is shown in the diagram
below:</p>
<img alt="../_images/velocity-odom-frame-rotation.gif" src="../_images/velocity-odom-frame-rotation.gif" />
<p>Once we have these, the configuration option can be added:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">gad_on130</span>
<span class="o">-</span><span class="n">attitude3_90</span><span class="mf">.0</span><span class="n">_180</span><span class="mf">.0</span><span class="n">_0</span><span class="mf">.0</span><span class="n">_0</span><span class="mf">.1</span>
<span class="o">-</span><span class="n">gad_att_id130_3</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This update frame requires that the lever arm is set to fixed in the packet,
otherwise the data will not be used by the INS. The values are irrelevant:
actual values are taken from the config options.</p>
</div>
</section>
</section>
</section>
<section id="covariance-matrix">
<span id="velocitycovariancematrix"></span><h2>Covariance matrix<a class="headerlink" href="#covariance-matrix" title="Link to this heading"></a></h2>
<p>All aiding provided to the INS must come with a covariance matrix. This is
necessary to give the Kalman Filter some indication of confidence in the data
being provided, which it can then use to inform its decision to use / reject
the data.</p>
<p>For velocity aiding, the values in covariance matrices are currently expected
with units <span class="math notranslate nohighlight">\((m/s)^2\)</span>. For example, a covariance matrix where motion in
all axes is found to be (or assumed to be) independent might look like this:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
0.01 &amp; 0.0  &amp; 0.0  \\
0.0  &amp; 0.01 &amp; 0.0  \\
0.0  &amp; 0.0  &amp; 0.01 \\
\end{bmatrix}
\label{CovExampleMatrix}\end{split}\]</div>
<p>This matrix shows that</p>
<div class="math notranslate nohighlight">
\[\sigma_x \sigma_x = \sigma_y \sigma_y = \sigma_z \sigma_z = 0.01 (m/s)^2 .\]</div>
</section>
<section id="lever-arm">
<span id="velocitylva"></span><h2>Lever Arm<a class="headerlink" href="#lever-arm" title="Link to this heading"></a></h2>
<p>Velocity measurements must be provided with a lever arm <span class="math notranslate nohighlight">\((x,y,z)\)</span> which
defines the translation from the IMU to the aiding sensor, in the IMU frame.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="generic-aiding-position-updates.html" class="btn btn-neutral float-left" title="Position" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="generic-aiding-attitude-updates.html" class="btn btn-neutral float-right" title="Attitude" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, OxTS.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>