<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Velocity &mdash; GAD-SDK 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=2709fde1"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../../_static/tabs.js?v=3030b3cb"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Speed" href="spe.html" />
    <link rel="prev" title="Position" href="pos.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            GAD-SDK
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Welcome</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Manual</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview of GAD SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Aiding types</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pos.html">Position</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Velocity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#aiding-frames">Aiding frames</a></li>
<li class="toctree-l3"><a class="reference internal" href="#covariance">Covariance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lever-arm">Lever arm</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code-examples">Code examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="spe.html">Speed</a></li>
<li class="toctree-l2"><a class="reference internal" href="att.html">Attitude</a></li>
<li class="toctree-l2"><a class="reference internal" href="hea.html">Heading</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ismydatabeingreceived.html">Debug Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GAD_post_processing.html">Post-processing GAD data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../section5.html">Advanced Options</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials and examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../my_first_gad.html">My first GAD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../static_aiding.html">Static-aiding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../example_can_ws.html">CAN wheel speed</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference section</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../KF.html">The Kalman Filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Frames.html">Frames</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lever_arm.html">Lever arms and Alignments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cov.html">Covariance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../time_stamping.html">Timestamping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Glossary.html">Glossary of terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GAD_cols.html">GAD file column definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../enum_tab.html">Table of GAD file Enums</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adv_com.html">Advanced commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gal-cpp/index.html">C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../py_com.html">Python API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">GAD-SDK</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Aiding types</a></li>
      <li class="breadcrumb-item active">Velocity</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/source/longform/aiding_types/vel.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="velocity">
<span id="vel-aidingtype"></span><h1>Velocity<a class="headerlink" href="#velocity" title="Link to this heading"></a></h1>
<p>You can use the generic aiding interface to send velocity data to your INS. Use the GadVelocity class to set the fields for this data type.</p>
<section id="aiding-frames">
<h2>Aiding frames<a class="headerlink" href="#aiding-frames" title="Link to this heading"></a></h2>
<p>Velocity aiding can be provided to the INS in one of three coordinate frames:</p>
<ul class="simple">
<li><p><strong>Odometry frame</strong> Velocity data measured in the coordinate frame of the sensor itself. An example of a device that might use the odometry frame is a camera mounted to the front of a car measuring velocity — it knows its velocity compared to objects around it, but not relative to Earth.</p></li>
<li><p><strong>North East Down (NED)</strong> The NED frame is the simplest way to provide velocity aiding to the INS, as it requires no other configuration (the INS itself uses NED). This frame is ideal for any sensors that provide data in a global frame, such as GNSS, and a use-case example would be to track an object’s velocity under open skies. It is important to note that the NED frame is curvilinear, in that the frame origin moves with the vehicle’s global position but is always oriented to NED at that point.</p></li>
<li><p><strong>User-defined local frame</strong> This works in a very similar way to NED, except that the velocity measurement is relative to a fixed reference frame on Earth. A use case would be an indoor positioning system with a fixed local frame defined by the physical setup of the system. .</p></li>
</ul>
<p>Regardless of the frame used, velocity data is expected in m/s.</p>
</section>
<section id="covariance">
<h2>Covariance<a class="headerlink" href="#covariance" title="Link to this heading"></a></h2>
<p>Covariance  is used as an estimate of the accuracy of a measurement.  Measurements with a smaller covariance will be given greater weight in the navigation solution, and any obvious outliers will be rejected by the navigation engine.
Whether using the NED, user-defined local or odometry frame, velocity covariance is expected in m/s squared. In your code, you can either add a diagonal covariance matrix, or a full covariance matrix. Note that you will need to add covariance for both your data, and for your lever arm.</p>
<p>To learn more about covariance and how to derive the values you need, see <a class="reference internal" href="../cov.html#cov"><span class="std std-ref">here</span></a>.</p>
</section>
<section id="lever-arm">
<h2>Lever arm<a class="headerlink" href="#lever-arm" title="Link to this heading"></a></h2>
<p>Velocity measurements must be provided with a lever arm (X,Y,Z) which defines the translation from the IMU to the aiding device, in the IMU frame. Note that odometry-frame velocity must also be provided with an orientation relative to the IMU frame. You can use the following lever arms with velocity data:</p>
<p><strong>Fixed</strong></p>
<p>A fixed lever arm is the simplest to set up, as it requires no external configuration. It is set within the generic aiding packet itself.</p>
<p><strong>Config</strong></p>
<p>A Config lever arm is functionally equivalent to a fixed lever arm. The difference is that the lever arm is set in the config file of the INS, instead of within the data packet.</p>
<p><a class="reference internal" href="../lever_arm.html#lever-arms"><span class="std std-ref">Learn more about lever arms.</span></a></p>
</section>
<section id="code-examples">
<h2>Code examples<a class="headerlink" href="#code-examples" title="Link to this heading"></a></h2>
<p>Here are two examples of how to configure the GadHandler to transmit velocity data:</p>
<p><strong>Example 1: Odometry frame, using a full covariance matrix and a config lever arm.</strong></p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-Qysr" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-Qysr" name="Qysr" role="tab" tabindex="0">C++</button><button aria-controls="panel-0-UHl0aG9u" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-0-Qysr" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-Qysr" name="Qysr" role="tabpanel" tabindex="0"><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">OxTS</span><span class="o">::</span><span class="n">Gal_Cpp</span><span class="o">::</span><span class="n">GadVelocity</span><span class="w"> </span><span class="nf">gv</span><span class="p">(</span><span class="mi">133</span><span class="p">);</span><span class="w"> </span><span class="c1">// Sets velocity aiding data to GAD stream ID 133</span>
<span class="n">gv</span><span class="p">.</span><span class="n">SetVelOdom</span><span class="p">(</span><span class="n">vx</span><span class="p">,</span><span class="w"> </span><span class="n">vy</span><span class="p">,</span><span class="w"> </span><span class="n">vz</span><span class="p">);</span><span class="w"> </span><span class="c1">// Set a measurement in the odometry frame, coming from your aiding device</span>
<span class="n">gv</span><span class="p">.</span><span class="n">SetVelOdomVar</span><span class="p">(</span><span class="n">var_x</span><span class="p">,</span><span class="w"> </span><span class="n">var_y</span><span class="p">,</span><span class="w"> </span><span class="n">var_z</span><span class="p">,</span><span class="w"> </span><span class="n">covar_xy</span><span class="p">,</span><span class="w"> </span><span class="n">covar_xz</span><span class="p">,</span><span class="w"> </span><span class="n">covar_yz</span><span class="p">);</span><span class="w"> </span><span class="c1">//Full covariance matrix, in (m/s)^2</span>
<span class="n">gv</span><span class="p">.</span><span class="n">SetAidingLeverArmConfig</span><span class="p">();</span><span class="w"> </span><span class="c1">//Set lever arm to &#39;config&#39;, i.e. set in the configuration file</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">gp</span> <span class="o">=</span> <span class="n">oxts_sdk</span><span class="o">.</span><span class="n">GadVelocity</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span> <span class="c1"># Sets velocity aiding data to GAD stream ID 133</span>
<span class="n">gv</span><span class="o">.</span><span class="n">vel_odom</span> <span class="o">=</span> <span class="p">[</span><span class="n">vx</span><span class="p">,</span>  <span class="n">vy</span><span class="p">,</span>  <span class="n">vx</span><span class="p">]</span> <span class="c1"># Set a measurement in the odometry frame, coming from your aiding device</span>
<span class="n">gv</span><span class="o">.</span><span class="n">vel_odom_var</span> <span class="o">=</span> <span class="p">[</span><span class="n">var_x</span><span class="p">,</span> <span class="n">var_y</span><span class="p">,</span> <span class="n">var_z</span><span class="p">,</span> <span class="n">covar_xy</span><span class="p">,</span> <span class="n">covar_xz</span><span class="p">,</span> <span class="n">covar_yz</span><span class="p">]</span> <span class="c1"># Full covariance matrix, in (m/s)^2</span>
<span class="n">gv</span><span class="o">.</span><span class="n">aiding_lever_arm_config</span><span class="p">()</span> <span class="c1"># Set lever arm to &#39;config&#39;, i.e. set in the configuration file</span>
</pre></div>
</div>
</div></div>
<p>Note that, in order for the config lever arm to work, you will need to add the following code to the config file of your INS. For example:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">location4_0</span><span class="mf">.0</span><span class="n">_0</span><span class="mf">.0</span><span class="n">_0</span><span class="mf">.1</span><span class="n">_0</span><span class="mf">.01</span><span class="w"> </span><span class="c1">// Set a lever arm with ID &#39;4&#39; to values 0.0m, 0.0m, 0.1m, diagonal variance 0.01m^2 for all</span>
<span class="o">-</span><span class="n">gad_loc_id133_4</span><span class="w"> </span><span class="c1">// Match the aiding stream with ID &#39;133&#39; with lever arm ID &#39;4&#39;</span>
</pre></div>
</div>
<p>Furthermore, if you are using the odometry frame, you need to provided the orientation of the sensor in the IMU frame.
This is done by adding the <cite>-attitude…</cite> command to the INS’ config file. For example:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">attitude3_3</span><span class="mf">.0</span><span class="n">_15</span><span class="mf">.0</span><span class="n">_0</span><span class="mf">.0</span><span class="n">_1</span><span class="mf">.0</span><span class="w"> </span><span class="c1">// Set an alignment with ID &#39;3&#39; and values 3, 15 and 0 degrees from the IMU axes respectively, variance 1.0 deg^2 for all</span>
<span class="o">-</span><span class="n">gad_att_id133_3</span><span class="w"> </span><span class="c1">// Match the aiding stream with ID &#39;133&#39; with alignment ID &#39;3&#39;</span>
</pre></div>
</div>
<p><strong>Example 2: NED frame, using a diagonal covariance matrix and a fixed lever arm.</strong></p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-Qysr" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-Qysr" name="Qysr" role="tab" tabindex="0">C++</button><button aria-controls="panel-1-UHl0aG9u" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-1-Qysr" class="sphinx-tabs-panel code-tab group-tab" id="panel-1-Qysr" name="Qysr" role="tabpanel" tabindex="0"><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">OxTS</span><span class="o">::</span><span class="n">Gal_Cpp</span><span class="o">::</span><span class="n">GadVelocity</span><span class="w"> </span><span class="nf">gv</span><span class="p">(</span><span class="mi">133</span><span class="p">);</span><span class="w"> </span><span class="c1">// Sets velocity aiding data to GAD stream ID 133</span>
<span class="n">gv</span><span class="p">.</span><span class="n">SetVelNed</span><span class="p">(</span><span class="n">v_north</span><span class="p">,</span><span class="w"> </span><span class="n">v_east</span><span class="p">,</span><span class="w"> </span><span class="n">v_down</span><span class="p">);</span><span class="w"> </span><span class="c1">// Set a velocity measurement using the NED frame</span>
<span class="n">gv</span><span class="p">.</span><span class="n">SetVelNedVar</span><span class="p">(</span><span class="n">var_n</span><span class="p">,</span><span class="w"> </span><span class="n">var_e</span><span class="p">,</span><span class="w"> </span><span class="n">var_d</span><span class="p">);</span><span class="w"> </span><span class="c1">// Diagonal covariance matrix, in (m/s)^2</span>
<span class="n">gv</span><span class="p">.</span><span class="n">SetAidingLeverArmFixed</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span><span class="w"> </span><span class="c1">// Lever arm sent in packet, measuring device is 0.1m vertically above the INS</span>
<span class="n">gv</span><span class="p">.</span><span class="n">SetAidingLeverArmVar</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">);</span><span class="w"> </span><span class="c1">// Lever arm variance, diagonal matrix with 0.1m standard deviation on each direction</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">gv</span> <span class="o">=</span> <span class="n">oxts_sdk</span><span class="o">.</span><span class="n">GadVelocity</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span> <span class="c1"># Sets velocity aiding data to GAD stream ID 133</span>
<span class="n">gv</span><span class="o">.</span><span class="n">vel_ned</span> <span class="o">=</span> <span class="p">[</span><span class="n">v_north</span><span class="p">,</span> <span class="n">v_east</span><span class="p">,</span> <span class="n">v_down</span><span class="p">]</span> <span class="c1"># Set a velocity measurement using the NED frame</span>
<span class="n">gv</span><span class="o">.</span><span class="n">vel_ned_var</span> <span class="o">=</span> <span class="p">[</span><span class="n">var_n</span><span class="p">,</span> <span class="n">var_e</span><span class="p">,</span> <span class="n">var_d</span><span class="p">]</span> <span class="c1"># Diagonal covariance matrix, in (m/s)^2</span>
<span class="n">gv</span><span class="o">.</span><span class="n">aiding_lever_arm_fixed</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span> <span class="c1"># Lever arm sent in packet, measuring device is 0.1m vertically above the INS</span>
<span class="n">gv</span><span class="o">.</span><span class="n">aiding_lever_arm_fixed_var</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span> <span class="c1"># Lever arm variance, diagonal matrix with 0.1m standard deviation on each direction</span>
</pre></div>
</div>
</div></div>
<p>Note for this example, the config file does not require any extra commands.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pos.html" class="btn btn-neutral float-left" title="Position" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="spe.html" class="btn btn-neutral float-right" title="Speed" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, OxTS.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>